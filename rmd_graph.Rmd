---
title: "code"
output: html_document
date: "2022-08-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(here)
library(patchwork)

q1 <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "QuebradaCuenca1-Bisley.csv"), na = "-9999") %>%
  clean_names()

q2 <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "QuebradaCuenca2-Bisley.csv"), na = "-9999") %>%
  clean_names()

q3 <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "QuebradaCuenca3-Bisley.csv"), na = "-9999") %>%
  clean_names()

prm <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "RioMameyesPuenteRoto.csv"), na = "-9999") %>%
  clean_names()
```



# Ata Code Chunk

```{r}

bq1 <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "QuebradaCuenca1-Bisley.csv"), na = "-9999", show_col_types = FALSE) %>%
  clean_names() %>% 
  mutate(site = "BQ1")

bq2 <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "QuebradaCuenca2-Bisley.csv"), na = "-9999", show_col_types = FALSE) %>%
  clean_names()%>% 
  mutate(site = "BQ2")

bq3 <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "QuebradaCuenca3-Bisley.csv"), na = "-9999", show_col_types = FALSE) %>%
  clean_names() %>% 
  mutate(site = "BQ3")

prm <- read_csv(here("/courses", "EDS214", "hurricaneducks", "raw_data_all", "RioMameyesPuenteRoto.csv"), na = "-9999",  show_col_types = FALSE) %>%
  clean_names()%>% 
  mutate(site = "PRM")



lef_table <- bind_rows(bq1, bq2, bq3, prm) %>%
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>%
  mutate(no3_n = as.numeric(no3_n)) %>%
  mutate(k = as.numeric(k)) %>%
  select(sample_date, sample_id, sample_time, no3_n, k, year, month, site)






```



# Elise Code Chunk

```{r}

```



# Lewis Code Chunk

```{r}
# Changing class of date to dateTime



q1_tidy <- q1 %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_id, sample_date, sample_time, no3_n, k, year, month) %>%
  mutate(k = as.numeric(k))

q2_tidy <- q2 %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_id, sample_date, sample_time, no3_n, k, year, month) %>%
  mutate(k = as.numeric(k))


q3_tidy <- q3 %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>%
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_id, sample_date, sample_time, no3_n, k, year, month) %>%
  mutate(k = as.numeric(k))

prm_tidy <- prm %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_id, sample_date, sample_time, no3_n, k, year, month) %>%
  mutate(k = as.numeric(k))

all_sites_select_years <- full_join(q1_tidy, q2_tidy) |> 
  full_join(q3_tidy) |> 
  full_join(prm_tidy) |> 
  filter(year >= 1987,
         year <= 1995) |>
  mutate(month_year = lubridate::ym(sample_date))

all_sites_select_years |> 
  group_by(month, year, sample_id) |> 
  summarize(mean_k = mean(k, na.rm = TRUE))


ggplot(data = all_sites_select_years, aes(x = sample_date, y = k)) +
  geom_line(aes(color = sample_id))
```



# Victoria Code Chunk

```{r}

library(tidyverse)
library(lubridate)
# wrangle data

all_sites <- full_join(prm, q1) %>% full_join(q2) %>% full_join(q3) %>% 
  mutate(year = lubridate::year(sample_date)) %>%  # let's isolate the year for our graph
  mutate(month = lubridate::month(sample_date)) %>% # let's isolate the month just in case we want it later for further analysis
  select(sample_id, sample_date, sample_time, no3_n, k, year, month) %>% 
  filter(year >= 1988 & year <= 1995) %>% 
  mutate(k = as.numeric(k)) %>% 
  mutate(no3_n = as.numeric(no3_n)) %>% 
  mutate(str_my = paste(year, month)) %>% 
  mutate(str_ym_date = lubridate::ym(str_my)) %>% 
  #pivot_longer('no3_n':'k', names_to = "measurement_type", values_to = "measurement_value") %>% 
  group_by(sample_id, str_ym_date) %>% summarize(mean_no3_n = mean(no3_n, na.rm = TRUE),
                                                 mean_k = mean(k, na.rm = TRUE))

  #mutate(yearmonth = lubridate::ym(sample_date)) %>% 
  #

# plot data 

no3_n_plot = ggplot(data = all_sites, mapping = aes(x = str_ym_date, y = mean_no3_n)) +
  geom_line(aes(color = sample_id)) +
  labs(x = "Mean K () per Month",
       y = )
#+
  #facet_wrap(vars(measurement_type), scales = "free")

no3_n_plot

k_plot = ggplot(data = all_sites, mapping = aes(x = str_ym_date, y = mean_k)) +
  geom_line(aes(color = sample_id)) 

k_plot

(k_plot / no3_n_plot)

```



# Wade Code Chunk

```{r}

# Changing class of date to dateTime

q1_ws <- q1 %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_date, sample_time, no3_n, k, year, month)

q2_ws <- q2 %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_date, sample_time, no3_n, k, year, month)


q3_ws <- q3 %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>%
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_date, sample_time, no3_n, k, year, month)


prm_ws <- prm %>% 
  mutate(sample_date = lubridate::ymd(sample_date)) %>% 
  mutate(year = lubridate::year(sample_date)) %>% 
  mutate(month = lubridate::month(sample_date)) %>% 
  select(sample_date, sample_time, no3_n, k, year, month)



```





